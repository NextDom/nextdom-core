<div class="box" style="display: none;" id="div_Health">
    <div class="box-header">
        <h3 class="box-title"><i class="icon divers-caduceus3"></i> {{ 'Santé de NextDom' }}</h3>
        <div class="box-tools pull-right">
            <button type="button" class="btn btn-box-too" ><i class="fas fa-tachometer-alt pull-right cursor" id="bt_benchmarkNextDom"></i></button>
            <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
            <button type="button" class="btn btn-box-tool btn-close" ><i class="fa fa-times"></i></button>
        </div>
    </div>
    <div class="box-body">
        <table class="table table-condensed table-bordered">
            <thead>
            <tr>
                <th style="width : 250px;"></th>
                <th style="width : 500px;">{{ 'Résultat' }}</th>
                <th>{{ 'Conseil' }}</th>
            </tr>
            </thead>
            <tbody>
            {% for informations in healthInformations %}
                <tr>
                    <td style="font-weight: bold;">
                        {{ informations['name'] }}
                        {{ informations['state'] }}
                        {{ informations['result'] }}
                    </td>
                    {% if informations['state'] == 1 or informations['state'] == true %}
                        <td class="alert alert-success">{{ informations['result'] }}</td>
                    {% elseif informations['state'] == 2 %}
                        <td class="alert alert-warning">{{ informations['result'] }}</td>
                    {% else %}
                        <td class="alert alert-danger">{{ informations['result'] }}</td>
                    {% endif %}
                    <td>
                        {{ informations['comment'] }}
                    </td>
                </tr>
            {% endfor %}
            {% if healthPluginDataToShow %}
                <tr>
                    <td style="font-weight : bold;">{{ 'Plugins' }}</td>
                    {% if healthTotalNOk == 0 and healthTotalPending == 0 %}
                        <td class="alert alert-success">{{ 'OK' }}</td>
                        <td></td>
                    {% elseif healthTotalNOk == 0 and healthTotalPending != 0 %}
                        <td class="alert alert-warning">{{ healthTotalPending }} {{ 'En cours' }}</td>
                        <td>{{ 'Vous pouvez voir les détails des plugins sur la partie basse de cette page' }}</td>
                    {% elseif healthTotalNOk != 0 %}
                        <td class="alert alert-danger">
                            {{ healthTotalNOk }} {{ 'NOK' }}
                            {% if healthTotalPending != 0 %}
                                {{ 'et' }} {{ healthTotalPending }} {{ 'En cours' }}
                            {% endif %}
                        </td>
                        <td>{{ 'Vous pouvez voir les détails des plugins sur la partie basse de cette page' }}</td>
                    {% endif %}
                </tr>
            {% endif %}
            </tbody>
        </table>
        {% if healthPluginDataToShow %}
            <div class="box-group" id="accordionHealth">
                {% for pluginData in healthPluginsInformations %}
                    <div class="panel box">
                        <div class="box-header with-border">
                            <h3 class="box-title">
                                <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordionHealth" href="#config_{{ pluginData['plugin'].getId() }}" style="text-decoration:none;">
                                    <img class="img-responsive" style="width : 20px;display:inline-block;" src="{{ pluginData['plugin'].getPathImgIcon() }}"/>
                                    {{ 'Santé' }} {{ pluginData['plugin'].getName() }}
                                </a>
                            </h3>
                            {% if pluginData['nOk'] > 0 %}
                                <span class="label label-danger pull-right" style="position:relative;">{{ pluginData['nOk'] }} {{ 'erreurs' }} </span>
                            {% endif %}
                            {% if pluginData['pending'] > 0 %}
                                <span class="label label-warning pull-right" style="position:relative;">{{ pluginData['pending'] }} {{ 'en cours' }} </span>
                            {% endif %}
                            {% if pluginData['nOk'] == 0 and pluginData['pending'] == 0 %}
                                <span class="label label-success pull-right" style="position:relative;">{{ 'OK' }}</span>
                            {% endif %}
                            <i class="fas fa-cogs bt_configurationPlugin cursor pull-right" style="color:grey;font-size:0.8em" data-pluginid="{{ pluginData['plugin'].getId() }}"></i>
                            {% if pluginData['hasSpecificHealth'] %}
                                <i data-pluginname="' . $plugin->getName() . '" data-pluginid="' . $plugin->getId() . '" class="fas fa-medkit bt_healthSpecific pull-right cursor" style="color:grey;font-size:0.8em" title="Santé spécifique"></i>
                            {% endif %}
                            {% if pluginData['hasOwnDaemon'] %}
                                {% if pluginData['daemonAuto'] == 1 %}
                                    <i class="fas fa-university pull-right" style="color:grey;font-size:0.8em" title="{{ 'Démon en mode automatique' }}"></i>
                                {% else %}
                                    <i class="fas fa-university pull-right" style="color:#ff4c4c;font-size:0.8em" title="{{ 'Démon en mode manuel' }}"></i>
                                {% endif %}
                            {% endif %}
                            {% if pluginData['port'] %}
                                <i class="icon techno-fleches pull-right" style="color:grey;font-size:0.8em" title="{{ 'Port configuré' }}"></i>
                                <span style="color:grey;font-size:0.8em" title="{{ 'Port configuré' }}" class="pull-right"> {{ pluginData['port']|capitalize }}</span>
                            {% endif %}
                        </div>
                        <div id="config_{{ pluginData['plugin'].getId() }}" class="panel-collapse collapse">
                            <div class="box-body">
                                {% if pluginData['showOnlyTable'] %}
                                    <table class="table table-condensed table-bordered">
                                        <thead>
                                        <tr>
                                            <th style="width: 250px;"></th>
                                            <th style="width: 150px;">{{ 'Résultat' }}</th>
                                            <th>{{ 'Conseil' }}</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        {% if pluginData['hasDependency'] %}
                                            <tr>
                                                <td style="font-weight : bold;">{{ 'Dépendance' }}</td>
                                                {% if pluginData['dependencyState'] == 'ok' %}
                                                    <td class="alert alert-success">{{ 'OK' }}</td>
                                                {% elseif pluginData['dependencyState'] == 'nok' %}
                                                    <td class="alert alert-danger">{{ 'NOK' }}</td>
                                                {% elseif pluginData['dependencyState'] == 'in_progress' %}
                                                    <td class="alert alert-info">{{ 'En cours' }}</td>
                                                {% else %}
                                                    <td class="alert alert-danger">{{ 'NOK' }}</td>
                                                {% endif %}
                                                <td></td>
                                            </tr>
                                        {% endif %}
                                        {% if pluginData['hasOwnDaemon'] %}
                                            <tr>
                                                <td style="font-weight: bold;">{{ 'Configuration démon' }}</td>
                                                {% if pluginData['daemonLaunchable'] == 'ok' %}
                                                    <td class="alert alert-success">{{ 'OK' }}</td>
                                                {% elseif pluginData['daemonLaunchable'] == 'nok' %}
                                                    {% if pluginData['daemonAuto'] != 1 %}
                                                        <td class="alert alert-success">{{ 'Désactivé' }}</td>
                                                    {% else %}
                                                        <td class="alert alert-danger" title="{{ pluginData['daemonLaunchableMessage'] }}">{{ 'NOK' }}</td>
                                                    {% endif %}
                                                {% endif %}
                                                <td>{{ pluginData['daemonLaunchableMessage'] }}</td>
                                            </tr>
                                            <tr>
                                                <td style="font-weight: bold;">{{ 'Statut démon' }}</td>
                                                {% if pluginData['daemonState'] == 'ok' %}
                                                    <td class="alert alert-success">{{ 'OK' }}</td>
                                                {% elseif pluginData['daemonState'] == 'nok' %}
                                                    {% if pluginData['daemonAuto'] != 1 %}
                                                        <td class="alert alert-success">{{ 'Désactivé' }}</td>
                                                    {% else %}
                                                        <td class="alert alert-danger">{{ 'NOK' }}</td>
                                                    {% endif %}
                                                {% endif %}
                                            </tr>
                                        {% endif %}
                                        {% if pluginData['health'] is defined %}
                                            {% for health in pluginData['health'] %}
                                                <tr>
                                                    <td style="font-weight: bold;">
                                                        {{ health['test'] }}
                                                    </td>
                                                    {% if health['state'] %}
                                                        <td class="alert alert-success"></td>
                                                    {% else %}
                                                        <td class="alert alert-danger"></td>
                                                    {% endif %}
                                                    <td>{{ health['advice'] }}</td>
                                                </tr>
                                            {% endfor %}
                                        {% endif %}
                                        </tbody>
                                    </table>
                                {% else %}
                                    <span class="label label-primary">{{ 'Aucune santé spécifique' }}</span>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    </div>
</div>